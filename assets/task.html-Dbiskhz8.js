import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,a as e,b as a,e as i,d as t,w as l,r,o as p}from"./app-C_uOi4cs.js";const d={};function o(c,s){const n=r("RouteLink");return p(),k("div",null,[s[13]||(s[13]=e(`<h1 id="silly-task" tabindex="-1"><a class="header-anchor" href="#silly-task"><span>silly.task</span></a></h1><p>åç¨‹ç®¡ç†å’Œä»»åŠ¡è°ƒåº¦æ¨¡å—ï¼Œæä¾›åç¨‹çš„åˆ›å»ºã€æŒ‚èµ·ã€å”¤é†’ä»¥åŠåˆ†å¸ƒå¼è¿½è¸ªåŠŸèƒ½ã€‚</p><h2 id="æ¨¡å—å¯¼å…¥" tabindex="-1"><a class="header-anchor" href="#æ¨¡å—å¯¼å…¥"><span>æ¨¡å—å¯¼å…¥</span></a></h2><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.task&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> trace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.trace&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åç¨‹ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#åç¨‹ç®¡ç†"><span>åç¨‹ç®¡ç†</span></a></h2><h3 id="task-running" tabindex="-1"><a class="header-anchor" href="#task-running"><span>task.running()</span></a></h3><p>è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„åç¨‹ã€‚</p><ul><li><strong>è¿”å›å€¼</strong>: <code>thread</code> - å½“å‰åç¨‹</li><li><strong>ç¤ºä¾‹</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.task&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> current_task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">running</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-fork-func-userdata" tabindex="-1"><a class="header-anchor" href="#task-fork-func-userdata"><span>task.fork(func, userdata)</span></a></h3><p>åˆ›å»ºå¹¶è°ƒåº¦ä¸€ä¸ªæ–°åç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚</p><ul><li><strong>å‚æ•°</strong>: <ul><li><code>func</code>: <code>async fun()</code> - å¼‚æ­¥å‡½æ•°</li><li><code>userdata</code>: <code>any</code> (å¯é€‰) - ä¼ é€’ç»™å”¤é†’æ—¶çš„å‚æ•°ï¼ˆé€šå¸¸ç”¨äºå†…éƒ¨æœºåˆ¶ï¼Œä¸šåŠ¡å±‚è¾ƒå°‘ä½¿ç”¨ï¼‰</li></ul></li><li><strong>è¿”å›å€¼</strong>: <code>thread</code> - æ–°åˆ›å»ºçš„åç¨‹</li><li><strong>ç¤ºä¾‹</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.task&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fork</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Hello from forked task&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-wait" tabindex="-1"><a class="header-anchor" href="#task-wait"><span>task.wait()</span></a></h3><p>æŒ‚èµ·å½“å‰åç¨‹ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚</p><ul><li><strong>è¿”å›å€¼</strong>: <code>any</code> - å”¤é†’æ—¶ä¼ å…¥çš„æ•°æ®</li><li><strong>æ³¨æ„</strong>: å¿…é¡»åœ¨åç¨‹ä¸­è°ƒç”¨ï¼Œä¸”åç¨‹çŠ¶æ€å¿…é¡»ä¸º &quot;RUN&quot;</li><li><strong>ç¤ºä¾‹</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.task&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fork</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wait</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Woken up with data:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-wakeup-task-result" tabindex="-1"><a class="header-anchor" href="#task-wakeup-task-result"><span>task.wakeup(task, result)</span></a></h3><p>å”¤é†’ä¸€ä¸ªæ­£åœ¨ç­‰å¾…çš„åç¨‹ã€‚</p><ul><li><strong>å‚æ•°</strong>: <ul><li><code>task</code>: <code>thread</code> - è¦å”¤é†’çš„åç¨‹</li><li><code>result</code>: <code>any</code> - ä¼ é€’ç»™åç¨‹çš„æ•°æ®</li></ul></li><li><strong>æ³¨æ„</strong>: ç›®æ ‡åç¨‹çŠ¶æ€å¿…é¡»ä¸º &quot;WAIT&quot;</li><li><strong>ç¤ºä¾‹</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.task&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.time&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> t</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fork</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">running</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wait</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Got:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å»¶è¿Ÿå”¤é†’ï¼Œç¡®ä¿åç¨‹å·²ç»è¿›å…¥waitçŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">after</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    task</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wakeup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;hello&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="task-status-task" tabindex="-1"><a class="header-anchor" href="#task-status-task"><span>task.status(task)</span></a></h3><p>è·å–åç¨‹çš„å½“å‰çŠ¶æ€ã€‚</p><ul><li><strong>å‚æ•°</strong>: <ul><li><code>task</code>: <code>thread</code> - ç›®æ ‡åç¨‹</li></ul></li><li><strong>è¿”å›å€¼</strong>: <code>string|nil</code> - çŠ¶æ€å­—ç¬¦ä¸²ï¼Œå¯èƒ½çš„å€¼ï¼š <ul><li><code>&quot;RUN&quot;</code> - æ­£åœ¨è¿è¡Œ</li><li><code>&quot;WAIT&quot;</code> - ç­‰å¾…ä¸­</li><li><code>&quot;READY&quot;</code> - å°±ç»ªé˜Ÿåˆ—ä¸­</li><li><code>&quot;SLEEP&quot;</code> - ç¡çœ ä¸­</li><li><code>&quot;EXIT&quot;</code> - å·²é€€å‡º</li><li><code>nil</code> - åç¨‹å·²é”€æ¯</li></ul></li></ul><h2 id="ä»»åŠ¡ç»Ÿè®¡" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡ç»Ÿè®¡"><span>ä»»åŠ¡ç»Ÿè®¡</span></a></h2><h3 id="task-readycount" tabindex="-1"><a class="header-anchor" href="#task-readycount"><span>task.readycount()</span></a></h3><p>è·å–å½“å‰å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡æ•°é‡ã€‚</p><ul><li><strong>è¿”å›å€¼</strong>: <code>integer</code> - ä»»åŠ¡æ•°é‡</li></ul><h3 id="task-inspect" tabindex="-1"><a class="header-anchor" href="#task-inspect"><span>task.inspect()</span></a></h3><p>è·å–æ‰€æœ‰åç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼ˆç”¨äºè°ƒè¯•ï¼‰ã€‚</p><ul><li><strong>è¿”å›å€¼</strong>: <code>table</code> - åç¨‹çŠ¶æ€è¡¨ï¼Œæ ¼å¼ï¼š</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">thread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] = {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        traceback</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;stack trace string&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;RUN|WAIT|READY|...&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åˆ†å¸ƒå¼è¿½è¸ª" tabindex="-1"><a class="header-anchor" href="#åˆ†å¸ƒå¼è¿½è¸ª"><span>åˆ†å¸ƒå¼è¿½è¸ª</span></a></h2><p>task æ¨¡å—æ”¯æŒä¸ºæ¯ä¸ªåç¨‹å…³è”åˆ†å¸ƒå¼è¿½è¸ª IDï¼Œç”¨äºå®ç°è·¨æœåŠ¡çš„è¯·æ±‚é“¾è·¯è¿½è¸ªã€‚</p>`,34)),a("blockquote",null,[a("p",null,[s[1]||(s[1]=i("ğŸ“– ",-1)),s[2]||(s[2]=a("strong",null,"å®Œæ•´æ–‡æ¡£",-1)),s[3]||(s[3]=i(": è¯¦ç»†çš„åˆ†å¸ƒå¼è¿½è¸ª API å’Œä½¿ç”¨æŒ‡å—è¯·å‚è§ ",-1)),a("strong",null,[t(n,{to:"/reference/trace.html"},{default:l(()=>[...s[0]||(s[0]=[i("silly.trace",-1)])]),_:1})]),s[4]||(s[4]=i(" æ¨¡å—æ–‡æ¡£ã€‚",-1))])]),s[14]||(s[14]=e(`<p><strong>å¿«é€Ÿç¤ºä¾‹</strong>ï¼š</p><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> trace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.trace&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- è®¾ç½®èŠ‚ç‚¹ IDï¼ˆæœåŠ¡å¯åŠ¨æ—¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">trace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setnode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- åˆ›å»ºæ–°çš„ traceï¼ˆå¤„ç†æ–°è¯·æ±‚æ—¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">trace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">spawn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ä¼ æ’­ trace åˆ°ä¸‹æ¸¸ï¼ˆè°ƒç”¨å…¶ä»–æœåŠ¡æ—¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> traceid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">trace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">propagate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- é™„åŠ ä¸Šæ¸¸çš„ traceï¼ˆæ¥æ”¶è¯·æ±‚æ—¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">trace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">attach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">upstream_traceid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç›¸å…³ API</strong>:</p>`,3)),a("ul",null,[a("li",null,[t(n,{to:"/reference/trace.html#tracesetnodenodeid"},{default:l(()=>[...s[5]||(s[5]=[i("trace.setnode()",-1)])]),_:1}),s[6]||(s[6]=i(" - è®¾ç½®èŠ‚ç‚¹ ID",-1))]),a("li",null,[t(n,{to:"/reference/trace.html#tracespawn"},{default:l(()=>[...s[7]||(s[7]=[i("trace.spawn()",-1)])]),_:1}),s[8]||(s[8]=i(" - åˆ›å»ºæ–° trace",-1))]),a("li",null,[t(n,{to:"/reference/trace.html#traceattachid"},{default:l(()=>[...s[9]||(s[9]=[i("trace.attach()",-1)])]),_:1}),s[10]||(s[10]=i(" - é™„åŠ  trace",-1))]),a("li",null,[t(n,{to:"/reference/trace.html#tracepropagate"},{default:l(()=>[...s[11]||(s[11]=[i("trace.propagate()",-1)])]),_:1}),s[12]||(s[12]=i(" - ä¼ æ’­ trace",-1))])]),s[15]||(s[15]=e('<h2 id="é«˜çº§api" tabindex="-1"><a class="header-anchor" href="#é«˜çº§api"><span>é«˜çº§API</span></a></h2><div class="hint-container caution"><p class="hint-container-title">å†…éƒ¨APIè­¦å‘Š</p><p>ä»¥ä¸‹å‡½æ•°ä»¥ <code>_</code> å¼€å¤´ï¼Œå±äºå†…éƒ¨å®ç°ç»†èŠ‚ï¼Œ<strong>ä¸åº”åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨</strong>ã€‚</p></div><h3 id="task-create-f" tabindex="-1"><a class="header-anchor" href="#task-create-f"><span>task._create(f)</span></a></h3><p>åˆ›å»ºåç¨‹ï¼ˆå†…éƒ¨APIï¼‰ã€‚</p><h3 id="task-resume-t" tabindex="-1"><a class="header-anchor" href="#task-resume-t"><span>task._resume(t, ...)</span></a></h3><p>æ¢å¤åç¨‹æ‰§è¡Œï¼ˆå†…éƒ¨APIï¼‰ã€‚</p><h3 id="task-yield" tabindex="-1"><a class="header-anchor" href="#task-yield"><span>task._yield(...)</span></a></h3><p>æŒ‚èµ·å½“å‰åç¨‹ï¼ˆå†…éƒ¨APIï¼‰ã€‚</p><h3 id="task-dispatch-wakeup" tabindex="-1"><a class="header-anchor" href="#task-dispatch-wakeup"><span>task._dispatch_wakeup()</span></a></h3><p>è°ƒåº¦å°±ç»ªé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼ˆå†…éƒ¨APIï¼‰ã€‚</p><h3 id="task-start-func" tabindex="-1"><a class="header-anchor" href="#task-start-func"><span>task._start(func)</span></a></h3><p>å¯åŠ¨ä¸»åç¨‹ï¼ˆå†…éƒ¨APIï¼‰ã€‚</p><h3 id="task-exit-status" tabindex="-1"><a class="header-anchor" href="#task-exit-status"><span>task._exit(status)</span></a></h3><p>é€€å‡ºè¿›ç¨‹ï¼ˆå†…éƒ¨APIï¼Œè¯·ä½¿ç”¨ <code>silly.exit</code>ï¼‰ã€‚</p><h3 id="task-hook-create-term" tabindex="-1"><a class="header-anchor" href="#task-hook-create-term"><span>task.hook(create, term)</span></a></h3><p>è®¾ç½®åç¨‹åˆ›å»ºå’Œç»ˆæ­¢çš„é’©å­å‡½æ•°ï¼ˆé«˜çº§ç”¨æ³•ï¼‰ã€‚</p><ul><li><strong>å‚æ•°</strong>: <ul><li><code>create</code>: <code>function|nil</code> - åˆ›å»ºé’©å­</li><li><code>term</code>: <code>function|nil</code> - ç»ˆæ­¢é’©å­</li></ul></li><li><strong>è¿”å›å€¼</strong>: <code>function, function</code> - å½“å‰çš„resumeå’Œyieldå‡½æ•°</li></ul>',17))])}const A=h(d,[["render",o]]),y=JSON.parse('{"path":"/reference/task.html","title":"silly.task","lang":"zh-CN","frontmatter":{"title":"silly.task","icon":"list-unordered","category":["APIå‚è€ƒ"],"tag":["æ ¸å¿ƒ","åç¨‹","è°ƒåº¦å™¨"],"description":"silly.task åç¨‹ç®¡ç†å’Œä»»åŠ¡è°ƒåº¦æ¨¡å—ï¼Œæä¾›åç¨‹çš„åˆ›å»ºã€æŒ‚èµ·ã€å”¤é†’ä»¥åŠåˆ†å¸ƒå¼è¿½è¸ªåŠŸèƒ½ã€‚ æ¨¡å—å¯¼å…¥ åç¨‹ç®¡ç† task.running() è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„åç¨‹ã€‚ è¿”å›å€¼: thread - å½“å‰åç¨‹ ç¤ºä¾‹: task.fork(func, userdata) åˆ›å»ºå¹¶è°ƒåº¦ä¸€ä¸ªæ–°åç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚ å‚æ•°: func: async fun() - å¼‚...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"silly.task\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-30T10:07:21.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"é‡å½’æ··æ²Œ\\",\\"url\\":\\"https://blog.gotocoding.com\\"}]}"],["meta",{"property":"og:url","content":"https://gotocoding.com/silly/reference/task.html"}],["meta",{"property":"og:site_name","content":"å‚è€ƒæ‰‹å†Œ"}],["meta",{"property":"og:title","content":"silly.task"}],["meta",{"property":"og:description","content":"silly.task åç¨‹ç®¡ç†å’Œä»»åŠ¡è°ƒåº¦æ¨¡å—ï¼Œæä¾›åç¨‹çš„åˆ›å»ºã€æŒ‚èµ·ã€å”¤é†’ä»¥åŠåˆ†å¸ƒå¼è¿½è¸ªåŠŸèƒ½ã€‚ æ¨¡å—å¯¼å…¥ åç¨‹ç®¡ç† task.running() è·å–å½“å‰æ­£åœ¨è¿è¡Œçš„åç¨‹ã€‚ è¿”å›å€¼: thread - å½“å‰åç¨‹ ç¤ºä¾‹: task.fork(func, userdata) åˆ›å»ºå¹¶è°ƒåº¦ä¸€ä¸ªæ–°åç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚ å‚æ•°: func: async fun() - å¼‚..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-11-30T10:07:21.000Z"}],["meta",{"property":"article:tag","content":"è°ƒåº¦å™¨"}],["meta",{"property":"article:tag","content":"åç¨‹"}],["meta",{"property":"article:tag","content":"æ ¸å¿ƒ"}],["meta",{"property":"article:modified_time","content":"2025-11-30T10:07:21.000Z"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://gotocoding.com/silly/en/reference/task.html"}]]},"git":{"createdTime":1759638427000,"updatedTime":1764497241000,"contributors":[{"name":"findstr","username":"findstr","email":"findstr@sina.com","commits":5,"url":"https://github.com/findstr"}]},"readingTime":{"minutes":2.59,"words":778},"filePathRelative":"reference/task.md","autoDesc":true}');export{A as comp,y as data};
