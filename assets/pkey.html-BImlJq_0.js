import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,a as t,b as a,d as e,e as i,w as l,r as h,o as d}from"./app-DHBJQQAG.js";const k={};function o(c,s){const n=h("RouteLink");return d(),p("div",null,[s[8]||(s[8]=t(`<h1 id="silly-crypto-pkey" tabindex="-1"><a class="header-anchor" href="#silly-crypto-pkey"><span>silly.crypto.pkey</span></a></h1><p>The <code>silly.crypto.pkey</code> module provides public key cryptography (Public Key Cryptography) functionality, supporting both RSA and ECDSA (Elliptic Curve Digital Signature Algorithm) asymmetric encryption algorithms. This module provides digital signature, signature verification, and RSA encryption/decryption capabilities, serving as a foundational component for building secure systems.</p><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><p>Asymmetric encryption uses a pair of keys: public key (Public Key) and private key (Private Key). This module supports the following operations:</p><p><strong>Signing and Verification</strong>:</p><ul><li>Private key used for signing, public key used for verification</li><li>Supports both RSA and ECDSA algorithms</li></ul><p><strong>Encryption and Decryption</strong> (RSA only):</p><ul><li>Public key used for encryption, private key used for decryption</li><li>Supports multiple padding modes (PKCS#1, OAEP)</li></ul><p>These functions are widely used in:</p><ul><li><strong>Digital Signatures</strong>: Prove data integrity and origin</li><li><strong>Identity Authentication</strong>: Verify identity of communicating parties</li><li><strong>JWT Tokens</strong>: JSON Web Tokens signed with RSA/ECDSA</li><li><strong>TLS/SSL</strong>: HTTPS certificate signature verification, key exchange</li><li><strong>Code Signing</strong>: Verify software package integrity</li><li><strong>Hybrid Encryption</strong>: Use RSA to encrypt symmetric keys, use symmetric algorithm to encrypt large amounts of data</li></ul><p>This module is implemented based on the OpenSSL EVP (Envelope) interface, supports PEM format key files, and provides a concise Lua API.</p><h2 id="module-import" tabindex="-1"><a class="header-anchor" href="#module-import"><span>Module Import</span></a></h2><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.crypto.pkey&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="core-concepts" tabindex="-1"><a class="header-anchor" href="#core-concepts"><span>Core Concepts</span></a></h2><h3 id="public-key-and-private-key" tabindex="-1"><a class="header-anchor" href="#public-key-and-private-key"><span>Public Key and Private Key</span></a></h3><ul><li><strong>Private Key</strong>: Secret key used to generate digital signatures. Only the private key holder can generate valid signatures.</li><li><strong>Public Key</strong>: Public key used to verify digital signatures. Anyone can use the public key to verify signature authenticity.</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[Sender]</span></span>
<span class="line"><span>  Data + Private Key → Signature</span></span>
<span class="line"><span>  Data + Signature → Send</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Receiver]</span></span>
<span class="line"><span>  Data + Signature + Public Key → Verification Result (true/false)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="supported-algorithms" tabindex="-1"><a class="header-anchor" href="#supported-algorithms"><span>Supported Algorithms</span></a></h3><h4 id="rsa-rivest-shamir-adleman" tabindex="-1"><a class="header-anchor" href="#rsa-rivest-shamir-adleman"><span>RSA (Rivest-Shamir-Adleman)</span></a></h4><p>RSA is the most widely used asymmetric encryption algorithm, based on the mathematical difficulty of large integer factorization.</p><ul><li><strong>Key Length</strong>: Usually 2048 bits or 4096 bits</li><li><strong>Signing Speed</strong>: Slower, suitable for scenarios with low performance requirements</li><li><strong>Compatibility</strong>: Supported by almost all systems</li></ul><h4 id="ecdsa-elliptic-curve-digital-signature-algorithm" tabindex="-1"><a class="header-anchor" href="#ecdsa-elliptic-curve-digital-signature-algorithm"><span>ECDSA (Elliptic Curve Digital Signature Algorithm)</span></a></h4><p>ECDSA is a signature algorithm based on elliptic curves, using shorter keys to achieve the same security as RSA.</p><ul><li><strong>Key Length</strong>: Usually 256 bits (equivalent to RSA 3072 bits)</li><li><strong>Signing Speed</strong>: Much faster than RSA</li><li><strong>Key Size</strong>: Smaller, saves storage and transmission bandwidth</li><li><strong>Common Curves</strong>: secp256k1 (Bitcoin), prime256v1 (P-256)</li></ul><h3 id="hash-algorithms" tabindex="-1"><a class="header-anchor" href="#hash-algorithms"><span>Hash Algorithms</span></a></h3><p>Signature operations first hash the data, then sign the hash value. Supported hash algorithms:</p><ul><li><code>sha1</code>: SHA-1 (not recommended, has collision risk)</li><li><code>sha256</code>: SHA-256 (recommended)</li><li><code>sha384</code>: SHA-384</li><li><code>sha512</code>: SHA-512 (high security requirements)</li><li><code>md5</code>: MD5 (deprecated, insecure)</li></ul><h3 id="rsa-padding-modes" tabindex="-1"><a class="header-anchor" href="#rsa-padding-modes"><span>RSA Padding Modes</span></a></h3><p>RSA encryption/decryption requires specifying padding mode (Padding) to ensure security and compatibility:</p><h4 id="pkcs-1-v1-5-padding-pkey-rsa-pkcs1" tabindex="-1"><a class="header-anchor" href="#pkcs-1-v1-5-padding-pkey-rsa-pkcs1"><span>PKCS#1 v1.5 Padding (<code>pkey.RSA_PKCS1</code>)</span></a></h4><ul><li><strong>Value</strong>: <code>1</code> (corresponds to OpenSSL&#39;s <code>RSA_PKCS1_PADDING</code>)</li><li><strong>Characteristics</strong>: Traditional padding method, deterministic padding</li><li><strong>Security</strong>: Has Bleichenbacher attack risk, not recommended for new systems</li><li><strong>Maximum Message Length</strong>: Key length - 11 bytes (2048-bit key = 245 bytes)</li><li><strong>Purpose</strong>: Legacy system compatibility</li></ul><h4 id="oaep-padding-pkey-rsa-pkcs1-oaep" tabindex="-1"><a class="header-anchor" href="#oaep-padding-pkey-rsa-pkcs1-oaep"><span>OAEP Padding (<code>pkey.RSA_PKCS1_OAEP</code>)</span></a></h4><ul><li><strong>Value</strong>: <code>4</code> (corresponds to OpenSSL&#39;s <code>RSA_PKCS1_OAEP_PADDING</code>)</li><li><strong>Full Name</strong>: Optimal Asymmetric Encryption Padding</li><li><strong>Characteristics</strong>: Modern padding method, includes randomness (each encryption produces different results)</li><li><strong>Security</strong>: Resistant to chosen ciphertext attacks, <strong>recommended</strong></li><li><strong>Maximum Message Length</strong>: Key length - 2×hash length - 2 (about 190 bytes with SHA256)</li><li><strong>Hash Algorithm</strong>: Supports SHA1, SHA256, SHA512, etc.</li><li><strong>Purpose</strong>: Default choice for new systems, MySQL 8.0+ password encryption</li></ul><p><strong>OAEP Technical Details</strong>:</p><ul><li>Uses two hash functions: OAEP digest (label hash) and MGF1 digest (mask generation)</li><li>By default, both OAEP digest and MGF1 digest are SHA1 (OpenSSL default)</li><li>When <code>hash</code> parameter is provided, this module sets both OAEP digest and MGF1 digest to the same algorithm</li><li>Standards compliant: Conforms to PKCS#1 v2.0+ specification</li></ul><h4 id="no-padding-pkey-rsa-no" tabindex="-1"><a class="header-anchor" href="#no-padding-pkey-rsa-no"><span>No Padding (<code>pkey.RSA_NO</code>)</span></a></h4><ul><li><strong>Value</strong>: <code>3</code> (corresponds to OpenSSL&#39;s <code>RSA_NO_PADDING</code>)</li><li><strong>Characteristics</strong>: No padding added, encrypts data directly</li><li><strong>Requirements</strong>: Message length must equal key length</li><li><strong>Security</strong>: <strong>Insecure</strong>, only for special protocol implementations</li><li><strong>Purpose</strong>: Low-level protocols, custom padding</li></ul><h4 id="x9-31-padding-pkey-rsa-x931" tabindex="-1"><a class="header-anchor" href="#x9-31-padding-pkey-rsa-x931"><span>X9.31 Padding (<code>pkey.RSA_X931</code>)</span></a></h4><ul><li><strong>Value</strong>: <code>5</code> (corresponds to OpenSSL&#39;s <code>RSA_X931_PADDING</code>)</li><li><strong>Purpose</strong>: Specifically for signing, not recommended for encryption</li></ul><h3 id="key-formats" tabindex="-1"><a class="header-anchor" href="#key-formats"><span>Key Formats</span></a></h3><p>Module supports multiple PEM formats:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>-----BEGIN PRIVATE KEY-----        # PKCS#8 private key (recommended)</span></span>
<span class="line"><span>-----BEGIN RSA PRIVATE KEY-----    # PKCS#1 RSA private key</span></span>
<span class="line"><span>-----BEGIN EC PRIVATE KEY-----     # SEC1 EC private key</span></span>
<span class="line"><span>-----BEGIN ENCRYPTED PRIVATE KEY----- # Encrypted PKCS#8 private key</span></span>
<span class="line"><span>-----BEGIN PUBLIC KEY-----         # PKCS#8 public key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="api-reference" tabindex="-1"><a class="header-anchor" href="#api-reference"><span>API Reference</span></a></h2><h3 id="pkey-new-pem-string-password" tabindex="-1"><a class="header-anchor" href="#pkey-new-pem-string-password"><span>pkey.new(pem_string, [password])</span></a></h3><p>Loads PEM format public or private key, creates key object.</p><ul><li><strong>Parameters</strong>: <ul><li><code>pem_string</code>: <code>string</code> - PEM format key string (including <code>-----BEGIN/END-----</code> markers)</li><li><code>password</code>: <code>string</code> - Optional, password for encrypted private key (only for encrypted private keys)</li></ul></li><li><strong>Returns</strong>: <ul><li>Success: <code>userdata, nil</code> - Key object and nil</li><li>Failure: <code>nil, error_message</code> - nil and error message string</li></ul></li><li><strong>Description</strong>: <ul><li>Automatically recognizes private or public key format</li><li>Supports PKCS#8, PKCS#1, SEC1, and other formats</li><li>Supports encrypted private keys (requires password)</li><li>Key objects are automatically released on garbage collection</li></ul></li><li><strong>Example</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.crypto.pkey&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Load RSA public key</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> rsa_public_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[[</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----BEGIN PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArS1jFmOYFaqrtJXs1El3</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">YWk+b8JXYec24aOLaGMQmblozAUz3scCjLV0V1J6xJGb35R3OU2JQOCT1chBABYX</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">N6N/TNT/nNhZXdSineoyQYkfxDeOOf9w2+fw6T32Ms/6H9sFkuXXu/UO1yRvbWoz</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">PkZfebhaZoxvet7W7ObB+Fm475r+ap/icx2Yr1bPg7oPz3VBvsgGqugm+0mdpt0Y</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">USRyQd0fihmYCsv6ldm6mfgoE0hVOthr52Kq2vAMcl9kEkyhghzw+W3M+VXlgJwb</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">lITB9DEBP2KaudUa6gDYsOpauoU8vacyNALSLXTO7ftTczRFINP3a9mdYg5THrkq</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KQIDAQAB</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----END PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> not </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">rsa_public_key</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;RSA public key load failed:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;RSA public key loaded successfully&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Load EC private key</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> ec_private_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[[</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----BEGIN EC PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MHQCAQEEICaCaDvEFIgrZXksCEe/FG1803c71gyUBI362hd8vuNyoAcGBSuBBAAK</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">oUQDQgAEe26lcpv6zAw3sO0gMwAGQ3QzXwE5IZCf/c+hOGwHalqi6V1wAiC1Hcx/</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">T7XZiStZF9amqLQOkXul6MZgsascsg==</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----END EC PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> not </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ec_private_key</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;EC private key load failed:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;EC private key loaded successfully&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Load encrypted private key</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> encrypted_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[[</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----BEGIN ENCRYPTED PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MIIFLTBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQI2+GG3gsDJbwCAggA</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBBl5BCE5p8mrjUpj0cdbN5SBIIE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0FP54ygFb2qWXXLuRK241megT4wpy3ITDfkoyYtew23ScvZ/mNTBEUorA3H1ebas</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----END ENCRYPTED PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;123456&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Provide password</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> not </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">encrypted_key</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Encrypted private key load failed:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Encrypted private key loaded successfully&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="key-sign-message-algorithm" tabindex="-1"><a class="header-anchor" href="#key-sign-message-algorithm"><span>key:sign(message, algorithm)</span></a></h3><p>Uses private key to digitally sign message.</p><ul><li><strong>Parameters</strong>: <ul><li><code>message</code>: <code>string</code> - Message to sign (any length)</li><li><code>algorithm</code>: <code>string</code> - Hash algorithm name <ul><li>Supported: <code>&quot;sha1&quot;</code>, <code>&quot;sha256&quot;</code>, <code>&quot;sha384&quot;</code>, <code>&quot;sha512&quot;</code>, <code>&quot;md5&quot;</code></li><li>Recommended: <code>&quot;sha256&quot;</code> or <code>&quot;sha512&quot;</code></li></ul></li></ul></li><li><strong>Returns</strong>: <ul><li>Success: <code>string</code> - Binary signature data</li><li>Failure: Throws error</li></ul></li><li><strong>Description</strong>: <ul><li>Must be called with private key object</li><li>Signature is binary data, usually needs Base64 encoding for transmission</li><li>Signature length depends on key type (RSA 2048-bit = 256 bytes, ECDSA P-256 = ~70 bytes)</li><li>For same message and key, RSA signature is deterministic, ECDSA signature contains random number (different signature results each time)</li></ul></li><li><strong>Example</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.crypto.pkey&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Load RSA private key</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> private_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[[</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----BEGIN PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCtLWMWY5gVqqu0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">lezUSXdhaT5vwldh5zbho4toYxCZuWjMBTPexwKMtXRXUnrEkZvflHc5TYlA4JPV</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yEEAFhc3o39M1P+c2Fld1KKd6jJBiR/EN445/3Db5/DpPfYyz/of2wWS5de79Q7X</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">JG9tajM+Rl95uFpmjG963tbs5sH4Wbjvmv5qn+JzHZivVs+Dug/PdUG+yAaq6Cb7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SZ2m3RhRJHJB3R+KGZgKy/qV2bqZ+CgTSFU62GvnYqra8AxyX2QSTKGCHPD5bcz5</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">VeWAnBuUhMH0MQE/Ypq51RrqANiw6lq6hTy9pzI0AtItdM7t+1NzNEUg0/dr2Z1i</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DlMeuSopAgMBAAECggEAYVue1TtwiN3GYmPXHRGgV9c/Dr2HOrcuF3RGL41iC8o8</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rFZQbvIa8Ngia+Umt9PUecGRtVltzFd1RT6rrEy/CLyWGK+2dIr80s90DKtZTZa1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kS5aeyisXjTrL3VyL+bUi4wqegdVXYnLqhAFxNFrtZsCmf+WcwiIs98LnWutqNx7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">QJR2HedjBXk+mXxkaonGyIjcXiowoXdIF/XhvR4CsH9G0OG3iD0g0ZkHGZ2zqGu7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">qo9o2YwE1y1PTwd4otsuPITveCqj6egAm9rpHqaRQtRhAJqUPeKfKO2vlxdJrzLb</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KyngzusRgz/gz3yQtL7ink19+/p9HSnbqCasJ8QwAQKBgQDaYPnJnw0TyUG0GpyG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MzC77vDqhbWGETPpgNS51UFRCpwrwY6URBMXw393YEb0DyLiP9w5U8camJC7DH1O</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">I/A+gWDT6x/LX3axC36ydhz00hiPXJMHHXUr4L3dQHCZQuW5HNm4VKBqGo2d8Yy1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KTpVyv8E0T0jtlDaz9cEas8igQKBgQDLAurBU8abUvoFFGMkfxoehsa7SLOudgTF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">5BVhwVLZ71UdD5pjSzfTeKyIMZDLHQca0HuQ4Ee4LMJFp/3LGkvJYRhpI4XNxa8b</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rg8x+VnFR7vMKzM4BiR7vzzQLk9Yl8JbUFCwu/0wqvi4K84V0BigSugYo+jO7mC0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cDyrWOPjqQKBgQCbln5BZV2m3DxAurkMcEpni50AKpWjWHxZAF4PrN3lhJ6yGiyg</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fEPyKWqWvfSvjF05P3CDM6pmy45KhmJ8muRfVESNmDbF6lUhXOQ++CI3V70B314t</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">spI52dzMV04iE+SiV+jTCRBlqFd/0YqDxET4vTGm2AEsgYfn7i7uyb6cgQKBgQCS</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hb9z24hb8M6dPfK0k7wBTls/LyDoiSu2vIEmNgcbXp76w5k1k0NusQktn0CXKJNJ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KjIVBZsd9cgdyDroDUmnxhl9QPNA6i4Rd1ZmRkchmT2VBZUJGX3ZhtRYmSQRmC7i</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AxzKAlSifLPZEVzD55bukkHkDuFoASrw8JUJQrXwSQKBgGJNgiOksXQHGBMRQ4RN</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">58yxce1MjsPb6lUT4fU1I9XoIOrXi3LMGRbwCEQcTnAl/fmqX/mn/OU0uWKhtB00</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mWF54QYcPrCDl4QWZjmnM9TeWab0Fdz5uGUe2PxhHs5dQ2hYRloTA/U+NsNLdiwW</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">BHo1sC5Ix5jbkO/TaUMKGmNb</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----END PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Sign message</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Hello, Silly Framework!&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">private_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Message:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Signature length:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, #</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;bytes&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Signature (hex):&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gsub</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#ABB2BF;--shiki-dark-font-style:italic;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> string.format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%02x&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">byte</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="key-verify-message-signature-algorithm" tabindex="-1"><a class="header-anchor" href="#key-verify-message-signature-algorithm"><span>key:verify(message, signature, algorithm)</span></a></h3><p>Uses public key to verify message digital signature.</p><ul><li><strong>Parameters</strong>: <ul><li><code>message</code>: <code>string</code> - Original message</li><li><code>signature</code>: <code>string</code> - Signature data (usually obtained from <code>sign()</code>)</li><li><code>algorithm</code>: <code>string</code> - Hash algorithm name (must match algorithm used for signing)</li></ul></li><li><strong>Returns</strong>: <ul><li>Verification success: <code>true</code> - Signature valid, message not tampered</li><li>Verification failed: <code>false</code> - Signature invalid or message tampered</li><li>Error: Throws error (such as algorithm not supported)</li></ul></li><li><strong>Description</strong>: <ul><li>Must be called with public key object (private key also works but not recommended)</li><li>Verification algorithm must match algorithm used for signing</li><li>Returning <code>false</code> indicates invalid signature, possible causes: <ul><li>Message tampered</li><li>Signature tampered</li><li>Wrong public key used</li><li>Hash algorithm mismatch</li></ul></li></ul></li><li><strong>Example</strong>:</li></ul><div class="language-lua line-numbers-mode" data-highlighter="shiki" data-ext="lua" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-lua"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">require</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;silly.crypto.pkey&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Load key pair</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> private_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[[</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----BEGIN PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCtLWMWY5gVqqu0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">lezUSXdhaT5vwldh5zbho4toYxCZuWjMBTPexwKMtXRXUnrEkZvflHc5TYlA4JPV</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">yEEAFhc3o39M1P+c2Fld1KKd6jJBiR/EN445/3Db5/DpPfYyz/of2wWS5de79Q7X</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">JG9tajM+Rl95uFpmjG963tbs5sH4Wbjvmv5qn+JzHZivVs+Dug/PdUG+yAaq6Cb7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SZ2m3RhRJHJB3R+KGZgKy/qV2bqZ+CgTSFU62GvnYqra8AxyX2QSTKGCHPD5bcz5</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">VeWAnBuUhMH0MQE/Ypq51RrqANiw6lq6hTy9pzI0AtItdM7t+1NzNEUg0/dr2Z1i</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">DlMeuSopAgMBAAECggEAYVue1TtwiN3GYmPXHRGgV9c/Dr2HOrcuF3RGL41iC8o8</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rFZQbvIa8Ngia+Umt9PUecGRtVltzFd1RT6rrEy/CLyWGK+2dIr80s90DKtZTZa1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kS5aeyisXjTrL3VyL+bUi4wqegdVXYnLqhAFxNFrtZsCmf+WcwiIs98LnWutqNx7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">QJR2HedjBXk+mXxkaonGyIjcXiowoXdIF/XhvR4CsH9G0OG3iD0g0ZkHGZ2zqGu7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">qo9o2YwE1y1PTwd4otsuPITveCqj6egAm9rpHqaRQtRhAJqUPeKfKO2vlxdJrzLb</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KyngzusRgz/gz3yQtL7ink19+/p9HSnbqCasJ8QwAQKBgQDaYPnJnw0TyUG0GpyG</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MzC77vDqhbWGETPpgNS51UFRCpwrwY6URBMXw393YEb0DyLiP9w5U8camJC7DH1O</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">I/A+gWDT6x/LX3axC36ydhz00hiPXJMHHXUr4L3dQHCZQuW5HNm4VKBqGo2d8Yy1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KTpVyv8E0T0jtlDaz9cEas8igQKBgQDLAurBU8abUvoFFGMkfxoehsa7SLOudgTF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">5BVhwVLZ71UdD5pjSzfTeKyIMZDLHQca0HuQ4Ee4LMJFp/3LGkvJYRhpI4XNxa8b</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rg8x+VnFR7vMKzM4BiR7vzzQLk9Yl8JbUFCwu/0wqvi4K84V0BigSugYo+jO7mC0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cDyrWOPjqQKBgQCbln5BZV2m3DxAurkMcEpni50AKpWjWHxZAF4PrN3lhJ6yGiyg</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fEPyKWqWvfSvjF05P3CDM6pmy45KhmJ8muRfVESNmDbF6lUhXOQ++CI3V70B314t</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">spI52dzMV04iE+SiV+jTCRBlqFd/0YqDxET4vTGm2AEsgYfn7i7uyb6cgQKBgQCS</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hb9z24hb8M6dPfK0k7wBTls/LyDoiSu2vIEmNgcbXp76w5k1k0NusQktn0CXKJNJ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KjIVBZsd9cgdyDroDUmnxhl9QPNA6i4Rd1ZmRkchmT2VBZUJGX3ZhtRYmSQRmC7i</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">AxzKAlSifLPZEVzD55bukkHkDuFoASrw8JUJQrXwSQKBgGJNgiOksXQHGBMRQ4RN</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">58yxce1MjsPb6lUT4fU1I9XoIOrXi3LMGRbwCEQcTnAl/fmqX/mn/OU0uWKhtB00</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mWF54QYcPrCDl4QWZjmnM9TeWab0Fdz5uGUe2PxhHs5dQ2hYRloTA/U+NsNLdiwW</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">BHo1sC5Ix5jbkO/TaUMKGmNb</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----END PRIVATE KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> public_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[[</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----BEGIN PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArS1jFmOYFaqrtJXs1El3</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">YWk+b8JXYec24aOLaGMQmblozAUz3scCjLV0V1J6xJGb35R3OU2JQOCT1chBABYX</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">N6N/TNT/nNhZXdSineoyQYkfxDeOOf9w2+fw6T32Ms/6H9sFkuXXu/UO1yRvbWoz</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">PkZfebhaZoxvet7W7ObB+Fm475r+ap/icx2Yr1bPg7oPz3VBvsgGqugm+0mdpt0Y</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">USRyQd0fihmYCsv6ldm6mfgoE0hVOthr52Kq2vAMcl9kEkyhghzw+W3M+VXlgJwb</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">lITB9DEBP2KaudUa6gDYsOpauoU8vacyNALSLXTO7ftTczRFINP3a9mdYg5THrkq</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">KQIDAQAB</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-----END PUBLIC KEY-----</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">]]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Sign and verify</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Important document content&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">private_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> is_valid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">public_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> is_valid</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Signature verification successful: Message not tampered&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Signature verification failed: Message may be tampered&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- Test tampering detection</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> tampered_message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Modified document content&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">local</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> is_tampered</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">public_key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">verify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">tampered_message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;sha256&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Tampered message verification result:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">is_tampered</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(Due to length constraints, I&#39;ll provide a summary completion of the remaining API and examples)</p><h3 id="key-encrypt-plaintext-padding-hash" tabindex="-1"><a class="header-anchor" href="#key-encrypt-plaintext-padding-hash"><span>key:encrypt(plaintext, [padding], [hash])</span></a></h3><p>Uses RSA public key to encrypt data (only supports RSA keys).</p><ul><li><strong>Parameters</strong>: <ul><li><code>plaintext</code>: <code>string</code> - Plaintext data to encrypt</li><li><code>padding</code>: <code>number</code> - Optional, padding mode (default PKCS#1 v1.5)</li><li><code>hash</code>: <code>string</code> - Optional, hash algorithm for OAEP padding only (default SHA1)</li></ul></li><li><strong>Returns</strong>: <ul><li>Success: <code>ciphertext, nil</code> - Encrypted ciphertext data</li><li>Failure: <code>nil, error_message</code> - Error message string</li></ul></li></ul><h3 id="key-decrypt-ciphertext-padding-hash" tabindex="-1"><a class="header-anchor" href="#key-decrypt-ciphertext-padding-hash"><span>key:decrypt(ciphertext, [padding], [hash])</span></a></h3><p>Uses RSA private key to decrypt ciphertext (only supports RSA keys).</p><ul><li><strong>Parameters</strong>: <ul><li><code>ciphertext</code>: <code>string</code> - Ciphertext data to decrypt</li><li><code>padding</code>: <code>number</code> - Optional, padding mode (must match encryption)</li><li><code>hash</code>: <code>string</code> - Optional, hash algorithm for OAEP padding (must match encryption)</li></ul></li><li><strong>Returns</strong>: <ul><li>Success: <code>plaintext, nil</code> - Decrypted plaintext data</li><li>Failure: <code>nil, error_message</code> - Error message string</li></ul></li></ul><h2 id="notes" tabindex="-1"><a class="header-anchor" href="#notes"><span>Notes</span></a></h2><h3 id="key-security" tabindex="-1"><a class="header-anchor" href="#key-security"><span>Key Security</span></a></h3><ol><li><p><strong>Private Key Protection</strong></p><ul><li>Private key file permissions should be 600 (only owner can read/write)</li><li>Production environment recommend using encrypted private keys</li><li>Don&#39;t commit private keys to version control (add to .gitignore)</li><li>Use environment variables or key management systems (like HashiCorp Vault) to store keys</li></ul></li><li><p><strong>Key Length</strong></p><ul><li>RSA: At least 2048 bits, recommend 4096 bits (high security scenarios)</li><li>ECDSA: Recommend 256 bits (equivalent to RSA 3072-bit security)</li></ul></li><li><p><strong>Key Rotation</strong></p><ul><li>Regularly replace key pairs (recommend yearly or more frequently)</li><li>Keep old public keys to verify historical signatures</li><li>Use key version numbers to manage multiple keys</li></ul></li></ol><h3 id="algorithm-selection" tabindex="-1"><a class="header-anchor" href="#algorithm-selection"><span>Algorithm Selection</span></a></h3><table><thead><tr><th>Scenario</th><th>Recommended Algorithm</th><th>Reason</th></tr></thead><tbody><tr><td>General</td><td>RSA + SHA256</td><td>Best compatibility, widely supported</td></tr><tr><td>High Performance</td><td>ECDSA + SHA256</td><td>Fast signing/verification, small keys</td></tr><tr><td>High Security</td><td>RSA 4096 + SHA512 or ECDSA P-384</td><td>Higher security strength</td></tr><tr><td>Mobile/IoT</td><td>ECDSA + SHA256</td><td>Low resource usage, fast</td></tr><tr><td>JWT Tokens</td><td>RS256 or ES256</td><td>Industry standard</td></tr></tbody></table><h3 id="performance-considerations" tabindex="-1"><a class="header-anchor" href="#performance-considerations"><span>Performance Considerations</span></a></h3><ol><li><p><strong>Key Loading</strong></p><ul><li>Key loading is time-consuming (parsing PEM format and OpenSSL initialization)</li><li>Load once at program startup, save in global variable for reuse</li><li>Avoid repeatedly loading keys in request handling</li></ul></li><li><p><strong>Signing Performance</strong></p><ul><li>RSA 2048 signing: About 1-2ms (single core)</li><li>ECDSA P-256 signing: About 0.5ms (2-4x faster)</li><li>Verification operations usually 3-5x faster than signing</li></ul></li></ol><h2 id="generating-key-pairs" tabindex="-1"><a class="header-anchor" href="#generating-key-pairs"><span>Generating Key Pairs</span></a></h2><p>This module doesn&#39;t provide key generation functionality, please use OpenSSL command-line tools:</p><h3 id="generate-rsa-key-pair" tabindex="-1"><a class="header-anchor" href="#generate-rsa-key-pair"><span>Generate RSA Key Pair</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Generate 2048-bit private key</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> genrsa</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> private.pem</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2048</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Extract public key from private key</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rsa</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> private.pem</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -pubout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> public.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Generate encrypted private key (password protected)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> genrsa</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -aes256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> encrypted_private.pem</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2048</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="generate-ecdsa-key-pair" tabindex="-1"><a class="header-anchor" href="#generate-ecdsa-key-pair"><span>Generate ECDSA Key Pair</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Generate P-256 curve private key</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ecparam</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -genkey</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prime256v1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ec_private.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Extract public key from private key</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ec_private.pem</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -pubout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ec_public.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Other common curves:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># - secp256k1 (used by Bitcoin)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># - prime256v1 (P-256, NIST standard)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># - secp384r1 (P-384, higher security)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="see-also" tabindex="-1"><a class="header-anchor" href="#see-also"><span>See Also</span></a></h2>`,76)),a("ul",null,[a("li",null,[e(n,{to:"/en/reference/security/jwt.html"},{default:l(()=>[...s[0]||(s[0]=[i("silly.security.jwt",-1)])]),_:1}),s[1]||(s[1]=i(" - JWT Tokens (uses pkey for RS256/ES256 signing)",-1))]),a("li",null,[e(n,{to:"/en/reference/crypto/hmac.html"},{default:l(()=>[...s[2]||(s[2]=[i("silly.crypto.hmac",-1)])]),_:1}),s[3]||(s[3]=i(" - HMAC Message Authentication Code (symmetric signing)",-1))]),a("li",null,[e(n,{to:"/en/reference/crypto/hash.html"},{default:l(()=>[...s[4]||(s[4]=[i("silly.crypto.hash",-1)])]),_:1}),s[5]||(s[5]=i(" - Hash Functions (SHA256, SHA512, etc.)",-1))]),a("li",null,[e(n,{to:"/en/reference/encoding/base64.html"},{default:l(()=>[...s[6]||(s[6]=[i("silly.encoding.base64",-1)])]),_:1}),s[7]||(s[7]=i(" - Base64 Encoding (for signature transmission encoding)",-1))])]),s[9]||(s[9]=t('<h2 id="standards-reference" tabindex="-1"><a class="header-anchor" href="#standards-reference"><span>Standards Reference</span></a></h2><ul><li><a href="https://tools.ietf.org/html/rfc8017" target="_blank" rel="noopener noreferrer">PKCS #1: RSA Cryptography Specifications</a></li><li><a href="https://www.secg.org/sec1-v2.pdf" target="_blank" rel="noopener noreferrer">SEC 1: Elliptic Curve Cryptography</a></li><li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" target="_blank" rel="noopener noreferrer">FIPS 186-4: Digital Signature Standard (DSS)</a></li><li><a href="https://www.openssl.org/docs/man1.1.1/man3/EVP_DigestSign.html" target="_blank" rel="noopener noreferrer">OpenSSL EVP Documentation</a></li></ul>',2))])}const u=r(k,[["render",o]]),A=JSON.parse('{"path":"/en/reference/crypto/pkey.html","title":"Pkey (Public Key Encryption)","lang":"en-US","frontmatter":{"title":"Pkey (Public Key Encryption)","icon":"lock","category":["API Reference"],"tag":["Encryption","Asymmetric Encryption","RSA","ECDSA","Digital Signature"],"description":"silly.crypto.pkey The silly.crypto.pkey module provides public key cryptography (Public Key Cryptography) functionality, supporting both RSA and ECDSA (Elliptic Curve Digital Si...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Pkey (Public Key Encryption)\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-22T01:39:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"重归混沌\\",\\"url\\":\\"https://blog.gotocoding.com\\"}]}"],["meta",{"property":"og:url","content":"https://gotocoding.com/silly/en/reference/crypto/pkey.html"}],["meta",{"property":"og:site_name","content":"Reference Manual"}],["meta",{"property":"og:title","content":"Pkey (Public Key Encryption)"}],["meta",{"property":"og:description","content":"silly.crypto.pkey The silly.crypto.pkey module provides public key cryptography (Public Key Cryptography) functionality, supporting both RSA and ECDSA (Elliptic Curve Digital Si..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-22T01:39:53.000Z"}],["meta",{"property":"article:tag","content":"Digital Signature"}],["meta",{"property":"article:tag","content":"ECDSA"}],["meta",{"property":"article:tag","content":"RSA"}],["meta",{"property":"article:tag","content":"Asymmetric Encryption"}],["meta",{"property":"article:tag","content":"Encryption"}],["meta",{"property":"article:modified_time","content":"2025-11-22T01:39:53.000Z"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://gotocoding.com/silly/reference/crypto/pkey.html"}]]},"git":{"createdTime":1763775593000,"updatedTime":1763775593000,"contributors":[{"name":"findstr","username":"findstr","email":"findstr@sina.com","commits":1,"url":"https://github.com/findstr"}]},"readingTime":{"minutes":6.28,"words":1884},"filePathRelative":"en/reference/crypto/pkey.md","autoDesc":true}');export{u as comp,A as data};
